version: "3.9"

services:
  govsearch-api:
    build:
      context: .
      dockerfile: Dockerfile.govsearch
    environment:
      DATABASE_URL: ${DATABASE_URL}
      PORT: 8001
    ports:
      - "8001:8001"

  govsearch-ui:
    build:
      context: .
      dockerfile: Dockerfile.govsearch
    command: [
      "streamlit", "run", "govsearch/ui/app.py",
      "--server.port", "8501",
      "--server.address", "0.0.0.0",
    ]
    environment:
      API_BASE: http://govsearch-api:8001
    depends_on:
      - govsearch-api
    ports:
      - "8501:8501"
